<!DOCTYPE html>
<!-- saved from url=(0041)https://bl.ocks.org/mbostock/raw/4062085/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>

svg {
  font: 10px sans-serif;
}

.y.axis path {
  display: none;
}

.y.axis line {
  stroke: #fff;
  stroke-opacity: .2;
  shape-rendering: crispEdges;
}

.y.axis .zero line {
  stroke: #000;
  stroke-opacity: 1;
}

.title {
  font: 300 78px Helvetica Neue;
  fill: #666;
}

.birthyear,
.age {
  text-anchor: middle;
}

.birthyear {
  fill: #fff;
}

rect {
  fill-opacity: .6;
  fill: #e377c2;
}

rect:first-child {
  fill: #1f77b4;
}

</style>
</head><body>
<!--<script src="./bl.ocks.org_files/d3.v3.min.js"></script>-->
<script src="../d3.min.js"></script>
<script>

var margin = {top: 20, right: 40, bottom: 30, left: 20},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom,
    barWidth = Math.floor(width / 19) - 1;

var x = d3.scale.linear()
    .range([barWidth / 2, width - barWidth / 2]);

var y = d3.scale.linear()
    .range([height, 0]);

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("right")
    .tickSize(-width)
    .tickFormat(function(d) { return Math.round(d / 1e6) + "M"; });

// An SVG element with a bottom-right origin.
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

// A sliding container to hold the bars by birthyear.
var birthyears = svg.append("g")
    .attr("class", "birthyears");

// A label for the current year.
var title = svg.append("text")
    .attr("class", "title")
    .attr("dy", ".71em")
    .text(2000);

d3.csv("data/population.csv", function(error, data) {
console.log('====data loaded');
  // Convert strings to numbers.
  data.forEach(function(d) {
    d.people = +d.people;
    d.year = +d.year;
    d.age = +d.age;
  });

  // Compute the extent of the data set in age and years.
  var age1 = d3.max(data, function(d) { return d.age; }),
      year0 = d3.min(data, function(d) { return d.year; }),
      year1 = d3.max(data, function(d) { return d.year; }),
      year = year1;

  // Update the scale domains.
  x.domain([year1 - age1, year1]);
  y.domain([0, d3.max(data, function(d) { return d.people; })]);

  // Produce a map from year and birthyear to [male, female].
  data = d3.nest()
      .key(function(d) { return d.year; })
      .key(function(d) { return d.year - d.age; })
      .rollup(function(v) { return v.map(function(d) { return d.people; }); })
      .map(data);

  // Add an axis to show the population values.
  svg.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(" + width + ",0)")
      .call(yAxis)
    .selectAll("g")
    .filter(function(value) { return !value; })
      .classed("zero", true);

  // Add labeled rects for each birthyear (so that no enter or exit is required).
  var birthyear = birthyears.selectAll(".birthyear")
      .data(d3.range(year0 - age1, year1 + 1, 5))
    .enter().append("g")
      .attr("class", "birthyear")
      .attr("transform", function(birthyear) { return "translate(" + x(birthyear) + ",0)"; });

  birthyear.selectAll("rect")
      .data(function(birthyear) { return data[year][birthyear] || [0, 0]; })
    .enter().append("rect")
      .attr("x", -barWidth / 2)
      .attr("width", barWidth)
      .attr("y", y)
      .attr("height", function(value) { return height - y(value); });

  // Add labels to show birthyear.
  birthyear.append("text")
      .attr("y", height - 4)
      .text(function(birthyear) { return birthyear; });

  // Add labels to show age (separate; not animated).
  svg.selectAll(".age")
      .data(d3.range(0, age1 + 1, 5))
    .enter().append("text")
      .attr("class", "age")
      .attr("x", function(age) { return x(year - age); })
      .attr("y", height + 4)
      .attr("dy", ".71em")
      .text(function(age) { return age; });

  // Allow the arrow keys to change the displayed year.
  window.focus();
  d3.select(window).on("keydown", function() {
    switch (d3.event.keyCode) {
      case 37: year = Math.max(year0, year - 10); break;
      case 39: year = Math.min(year1, year + 10); break;
    }
    update();
  });

  function update() {
    if (!(year in data)) return;
    title.text(year);

    birthyears.transition()
        .duration(750)
        .attr("transform", "translate(" + (x(year1) - x(year)) + ",0)");

    birthyear.selectAll("rect")
        .data(function(birthyear) { return data[year][birthyear] || [0, 0]; })
      .transition()
        .duration(750)
        .attr("y", y)
        .attr("height", function(value) { return height - y(value); });
  }
});

</script><svg width="960" height="500"><g transform="translate(20,20)"><g class="birthyears" transform=""><g class="birthyear" transform="translate(-1400.3333333333335,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1760</text></g><g class="birthyear" transform="translate(-1352.888888888889,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1765</text></g><g class="birthyear" transform="translate(-1305.4444444444443,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1770</text></g><g class="birthyear" transform="translate(-1258,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1775</text></g><g class="birthyear" transform="translate(-1210.5555555555557,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1780</text></g><g class="birthyear" transform="translate(-1163.111111111111,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1785</text></g><g class="birthyear" transform="translate(-1115.6666666666665,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1790</text></g><g class="birthyear" transform="translate(-1068.2222222222222,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1795</text></g><g class="birthyear" transform="translate(-1020.7777777777778,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1800</text></g><g class="birthyear" transform="translate(-973.3333333333334,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1805</text></g><g class="birthyear" transform="translate(-925.8888888888889,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1810</text></g><g class="birthyear" transform="translate(-878.4444444444446,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1815</text></g><g class="birthyear" transform="translate(-831,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1820</text></g><g class="birthyear" transform="translate(-783.5555555555555,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1825</text></g><g class="birthyear" transform="translate(-736.1111111111111,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1830</text></g><g class="birthyear" transform="translate(-688.6666666666667,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1835</text></g><g class="birthyear" transform="translate(-641.2222222222222,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1840</text></g><g class="birthyear" transform="translate(-593.7777777777778,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1845</text></g><g class="birthyear" transform="translate(-546.3333333333333,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1850</text></g><g class="birthyear" transform="translate(-498.8888888888889,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1855</text></g><g class="birthyear" transform="translate(-451.44444444444446,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1860</text></g><g class="birthyear" transform="translate(-404,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1865</text></g><g class="birthyear" transform="translate(-356.55555555555554,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1870</text></g><g class="birthyear" transform="translate(-309.1111111111111,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1875</text></g><g class="birthyear" transform="translate(-261.66666666666663,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1880</text></g><g class="birthyear" transform="translate(-214.22222222222223,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1885</text></g><g class="birthyear" transform="translate(-166.77777777777777,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1890</text></g><g class="birthyear" transform="translate(-119.33333333333331,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1895</text></g><g class="birthyear" transform="translate(-71.88888888888889,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1900</text></g><g class="birthyear" transform="translate(-24.444444444444443,0)"><rect x="-23" width="46" y="450" height="0"></rect><rect x="-23" width="46" y="450" height="0"></rect><text y="446">1905</text></g><g class="birthyear" transform="translate(23,0)"><rect x="-23" width="46" y="436.99373141863106" height="13.006268581368943"></rect><rect x="-23" width="46" y="408.82812103186006" height="41.171878968139936"></rect><text y="446">1910</text></g><g class="birthyear" transform="translate(70.44444444444444,0)"><rect x="-23" width="46" y="412.47216420367516" height="37.52783579632484"></rect><rect x="-23" width="46" y="373.3802641142345" height="76.61973588576552"></rect><text y="446">1915</text></g><g class="birthyear" transform="translate(117.88888888888889,0)"><rect x="-23" width="46" y="376.4168894089001" height="73.58311059109991"></rect><rect x="-23" width="46" y="325.3954893956477" height="124.6045106043523"></rect><text y="446">1920</text></g><g class="birthyear" transform="translate(165.33333333333331,0)"><rect x="-23" width="46" y="337.3552325882695" height="112.64476741173053"></rect><rect x="-23" width="46" y="281.5487054566025" height="168.45129454339752"></rect><text y="446">1925</text></g><g class="birthyear" transform="translate(212.77777777777777,0)"><rect x="-23" width="46" y="303.3416104837144" height="146.65838951628558"></rect><rect x="-23" width="46" y="249.47958630920996" height="200.52041369079004"></rect><text y="446">1930</text></g><g class="birthyear" transform="translate(260.22222222222223,0)"><rect x="-23" width="46" y="277.75944045053967" height="172.24055954946033"></rect><rect x="-23" width="46" y="264.1785497617795" height="185.8214502382205"></rect><text y="446">1935</text></g><g class="birthyear" transform="translate(307.66666666666663,0)"><rect x="-23" width="46" y="251.85635143451842" height="198.14364856548158"></rect><rect x="-23" width="46" y="230.7571465514552" height="219.2428534485448"></rect><text y="446">1940</text></g><g class="birthyear" transform="translate(355.1111111111111,0)"><rect x="-23" width="46" y="200.19980410199793" height="249.80019589800207"></rect><rect x="-23" width="46" y="182.3251040530879" height="267.6748959469121"></rect><text y="446">1945</text></g><g class="birthyear" transform="translate(402.55555555555554,0)"><rect x="-23" width="46" y="120.96197572855208" height="329.0380242714479"></rect><rect x="-23" width="46" y="105.36855406493513" height="344.6314459350649"></rect><text y="446">1950</text></g><g class="birthyear" transform="translate(450,0)"><rect x="-23" width="46" y="66.15776931012086" height="383.84223068987916"></rect><rect x="-23" width="46" y="53.15366648713218" height="396.84633351286783"></rect><text y="446">1955</text></g><g class="birthyear" transform="translate(497.44444444444446,0)"><rect x="-23" width="46" y="12.197667220396102" height="437.8023327796039"></rect><rect x="-23" width="46" y="5.687784271901658" height="444.31221572809835"></rect><text y="446">1960</text></g><g class="birthyear" transform="translate(544.8888888888889,0)"><rect x="-23" width="46" y="6.205864615865386" height="443.7941353841346"></rect><rect x="-23" width="46" y="0" height="450"></rect><text y="446">1965</text></g><g class="birthyear" transform="translate(592.3333333333333,0)"><rect x="-23" width="46" y="55.29521478264166" height="394.70478521735834"></rect><rect x="-23" width="46" y="58.64374795832152" height="391.3562520416785"></rect><text y="446">1970</text></g><g class="birthyear" transform="translate(639.7777777777778,0)"><rect x="-23" width="46" y="76.42628725330013" height="373.57371274669987"></rect><rect x="-23" width="46" y="81.87881602114604" height="368.121183978854"></rect><text y="446">1975</text></g><g class="birthyear" transform="translate(687.2222222222222,0)"><rect x="-23" width="46" y="73.64862478210277" height="376.3513752178972"></rect><rect x="-23" width="46" y="89.39179316801206" height="360.60820683198796"></rect><text y="446">1980</text></g><g class="birthyear" transform="translate(734.6666666666667,0)"><rect x="-23" width="46" y="54.075428723473664" height="395.9245712765263"></rect><rect x="-23" width="46" y="75.14323011002311" height="374.8567698899769"></rect><text y="446">1985</text></g><g class="birthyear" transform="translate(782.1111111111111,0)"><rect x="-23" width="46" y="41.4748144215788" height="408.5251855784212"></rect><rect x="-23" width="46" y="62.38633313643842" height="387.6136668635616"></rect><text y="446">1990</text></g><g class="birthyear" transform="translate(829.5555555555555,0)"><rect x="-23" width="46" y="41.90359590661354" height="408.09640409338647"></rect><rect x="-23" width="46" y="60.56709609701979" height="389.43290390298023"></rect><text y="446">1995</text></g><g class="birthyear" transform="translate(877,0)"><rect x="-23" width="46" y="73.49141392824997" height="376.50858607175"></rect><rect x="-23" width="46" y="89.91505586238564" height="360.08494413761434"></rect><text y="446">2000</text></g></g><text class="title" dy=".71em">2000</text><g class="y axis" transform="translate(900,0)"><g class="tick zero" transform="translate(0,450)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">0M</text></g><g class="tick" transform="translate(0,411.32574320963846)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">1M</text></g><g class="tick" transform="translate(0,372.6514864192769)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">2M</text></g><g class="tick" transform="translate(0,333.9772296289154)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">3M</text></g><g class="tick" transform="translate(0,295.3029728385538)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">4M</text></g><g class="tick" transform="translate(0,256.62871604819225)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">5M</text></g><g class="tick" transform="translate(0,217.9544592578307)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">6M</text></g><g class="tick" transform="translate(0,179.28020246746914)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">7M</text></g><g class="tick" transform="translate(0,140.6059456771076)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">8M</text></g><g class="tick" transform="translate(0,101.93168888674606)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">9M</text></g><g class="tick" transform="translate(0,63.25743209638451)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">10M</text></g><g class="tick" transform="translate(0,24.583175306022927)" style="opacity: 1;"><line x2="-900" y2="0"></line><text dy=".32em" x="3" y="0" style="text-anchor: start;">11M</text></g><path class="domain" d="M-900,0H0V450H-900"></path></g><text class="age" x="877" y="454" dy=".71em">0</text><text class="age" x="829.5555555555555" y="454" dy=".71em">5</text><text class="age" x="782.1111111111111" y="454" dy=".71em">10</text><text class="age" x="734.6666666666667" y="454" dy=".71em">15</text><text class="age" x="687.2222222222222" y="454" dy=".71em">20</text><text class="age" x="639.7777777777778" y="454" dy=".71em">25</text><text class="age" x="592.3333333333333" y="454" dy=".71em">30</text><text class="age" x="544.8888888888889" y="454" dy=".71em">35</text><text class="age" x="497.44444444444446" y="454" dy=".71em">40</text><text class="age" x="450" y="454" dy=".71em">45</text><text class="age" x="402.55555555555554" y="454" dy=".71em">50</text><text class="age" x="355.1111111111111" y="454" dy=".71em">55</text><text class="age" x="307.66666666666663" y="454" dy=".71em">60</text><text class="age" x="260.22222222222223" y="454" dy=".71em">65</text><text class="age" x="212.77777777777777" y="454" dy=".71em">70</text><text class="age" x="165.33333333333331" y="454" dy=".71em">75</text><text class="age" x="117.88888888888889" y="454" dy=".71em">80</text><text class="age" x="70.44444444444444" y="454" dy=".71em">85</text><text class="age" x="23" y="454" dy=".71em">90</text></g></svg>
<script id="wappalyzer" src="chrome-extension://gppongmhjkpfnbhagpmjfkannfbllamg/js/inject.js"></script><div id="download_plus_animation"></div></body></html>
